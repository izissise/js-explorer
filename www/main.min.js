function ConvertJsonToTable(e,t,n,a){var o="<i>{0}</i>",r=t?' id="'+t+'"':"",s=n?' class="'+n+'"':"",c='<table border="1" cellpadding="1" cellspacing="1"'+r+s+">{0}{1}</table>",l="<thead>{0}</thead>",p="<tbody>{0}</tbody>",d="<tr>{0}</tr>",f="<th>{0}</th>",u="<td>{0}</td>",m="",g="",x="";if(e){var h,v="string"==typeof e[0];if(v)m+=f.format("value");else if("object"==typeof e[0])for(h=array_keys(e[0]),i=0;i<h.length;i++)m+=f.format(h[i]);if(l=l.format(d.format(m)),v)for(i=0;i<e.length;i++)g+=u.format(e[i]),x+=d.format(g),g="";else if(h)for(i=0;i<e.length;i++){for(j=0;j<h.length;j++){var y=e[i][h[j]];g+=y?u.format(y):u.format(o.format(y).toUpperCase())}x+=d.format(g),g=""}return p=p.format(x),c=c.format(l,p)}return null}function array_keys(e,t,i){var n="undefined"!=typeof t,a=[],o=!!i,r=!0,s="";if(e&&"object"==typeof e&&e.change_key_case)return e.keys(t,i);for(s in e)e.hasOwnProperty(s)&&(r=!0,n&&(o&&e[s]!==t?r=!1:e[s]!=t&&(r=!1)),r&&(a[a.length]=s));return a}function historyFileApp(e){var t={location:e},i="Files Listing",n=window.location.href;history.pushState(t,i,n),fileApp(e)}function fileApp(e){var t=fadeOut(filesapp,150);get(e).then(function(e){return JSON.parse(e)}).then(function(i){if(i.length<=0)filesapp.innerHTML='<h3 style="center;">The directory is empty</h3>';else{orderField(i);var n=ConvertJsonToTable(i,null,null,null),a=document.createElement("div");a.innerHTML=n,addSortInfo(a.getElementsByTagName("th")),addSortValue(a.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),e),a.getElementsByTagName("thead")[0].getElementsByTagName("tr")[0].deleteCell(3);new Tablesort(a.getElementsByTagName("table")[0]);t.then(function(e){return filesapp.innerHTML="",filesapp.appendChild(a),fadeIn(filesapp,150)})}},function(e){console.error(e),filesapp.innerHTML='<h3 style="center;">An error occured</h3>'})}function orderField(e){e.forEach(function(e){var t=e.size;void 0===e.size&&(t="-"),e.Filename=e.name,e.Size=t.toString(),e.Date=e.mtime,e.Type=e.type,delete e.size,delete e.name,delete e.type,delete e.mtime})}function addSortInfo(e){e[0].setAttribute("data-sort-method","default"),e[1].setAttribute("data-sort-method","number"),e[2].setAttribute("data-sort-method","date"),e[2].className+="sort-default",e[3].setAttribute("data-sort-method","default")}function addSortValue(e,t){var i=new Date;[].forEach.call(e,function(e){var n=e.getElementsByTagName("td");formatNameField(n[0],n[3],t),formatSizeField(n[1]),formatDateField(n[2],i),e.deleteCell(3)})}function formatNameField(e,t,i){var n=e.innerHTML,a=t.innerHTML;n=escape(n),console.log(n),n=n.replace(/\%C3\%u201A/g,"Â"),n=n.replace(/\%C3\%u20AC/g,"À"),n=n.replace(/\%C3\%u2021/g,"Ç");try{n=decodeURIComponent(n)}catch(o){}e.setAttribute("data-sort",n),"directory"==a?e.innerHTML=directoryfy(i,n):e.innerHTML=linkify(i,n)}function formatSizeField(e){var t=e.innerHTML;e.setAttribute("data-sort","-"==t?"-":t),e.innerHTML="-"==t?"-":humanFileSize(parseInt(t),!1)}function formatDateField(e,t){var i=new Date(e.innerHTML);if(e.setAttribute("data-sort",i.toISOString()),t.getTime()-i.getTime()>1728e5)e.innerHTML=[i.getHours().padLeft(),i.getMinutes().padLeft(),i.getSeconds().padLeft()].join(":")+" "+[i.getDate().padLeft(),(i.getMonth()+1).padLeft(),i.getFullYear()].join("/");else if(t.getTime()-i.getTime()<6e4){var n=Math.round((t.getTime()-i.getTime())/1e3),a=1==n?"second":"seconds";e.innerHTML=[n.toString(),a,"ago"].join(" ")}else if(t.getTime()-i.getTime()<36e5){var o=Math.round((t.getTime()-i.getTime())/6e4),r=1==o?"minute":"minutes";e.innerHTML=[o.toString(),r,"ago"].join(" ")}else if(t.getTime()-i.getTime()<864e5){var s=Math.round((t.getTime()-i.getTime())/36e5),c=1==s?"hour":"hours";e.innerHTML=[s.toString(),c,"ago"].join(" ")}else e.innerHTML="Yesterday"}function directoryfy(e,t){return['<a href="javascript:void(0)" onclick=\'historyFileApp("',escapeHtml(e),escapeHtml(t),"/\")'>",iconFor(t,!0),t,"</a>"].join("")}function linkify(e,t){return['<a href="',escapeHtml(e),escapeHtml(t),'">',iconFor(t,!1),t,"</a>"].join("")}function iconFor(e,t){var i="<img src='/icons/{0}.svg' width=24 class='fileicon'>";if(t)return i.format("folder");var n=e.slice(e.lastIndexOf(".")+1),a="application-octet-stream";return void 0!==IconMap[n]&&(a=IconMap[n]),i.format(a)}function get(e){return new Promise(function(t,i){var n=new XMLHttpRequest;n.overrideMimeType("text/html; charset=ISO-8859-1"),n.onerror=function(){i(Error("Network Error"))},n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(n.status>=200&&n.status<400?t(n.responseText):i(n))},n.open("GET",e,!0),n.send()})}function escapeHtml(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function humanFileSize(e,t){var i=t?1e3:1024;if(Math.abs(e)<i)return e+" B";var n=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=-1;do e/=i,++a;while(Math.abs(e)>=i&&a<n.length-1);return e.toFixed(1)+" "+n[a]}function fadeOut(e,t){return new Promise(function(i){e.style.opacity=1;var n=1,a=new Date;!function o(){var r=Math.min(1,(new Date-a)/t);n=1-r,r<1?(e.style.opacity=n,requestAnimationFrame(o)):i(e)}()})}function fadeIn(e,t){return new Promise(function(i){e.style.opacity=0;var n=0,a=new Date;!function o(){var r=Math.min(1,(new Date-a)/t);n=r,r<1?(e.style.opacity=n,requestAnimationFrame(o)):(e.style.opacity=1,i(e))}()})}String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,i){return"undefined"!=typeof e[i]?e[i]:"{"+i+"}"})},!function(){function e(e,t){if(!e||"TABLE"!==e.tagName)throw new Error("Element must be a table");this.init(e,t||{})}var t=[],i=function(e){var t;return window.CustomEvent&&"function"==typeof window.CustomEvent?t=new CustomEvent(e):(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!1,!1,void 0)),t},n=function(e){return e.getAttribute("data-sort")||e.textContent||e.innerText||""},a=function(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),e===t?0:t>e?1:-1},o=function(e,t){return function(i,n){var a=e(i.td,n.td);return 0===a?t?n.index-i.index:i.index-n.index:a}};e.extend=function(e,i,n){if("function"!=typeof i||"function"!=typeof n)throw new Error("Pattern and sort must be a function");t.push({name:e,pattern:i,sort:n})},e.prototype={init:function(e,t){var i,n,a,o,r=this;if(r.table=e,r.thead=!1,r.options=t,e.rows&&e.rows.length>0&&(e.tHead&&e.tHead.rows.length>0?(i=e.tHead.rows[e.tHead.rows.length-1],r.thead=!0):i=e.rows[0]),i){var s=function(){r.current&&r.current!==this&&(r.current.classList.remove("sort-up"),r.current.classList.remove("sort-down")),r.current=this,r.sortTable(this)};for(a=0;a<i.cells.length;a++)o=i.cells[a],o.classList.contains("no-sort")||(o.classList.add("sort-header"),o.addEventListener("click",s,!1),o.classList.contains("sort-default")&&(n=o));n&&(r.current=n,r.sortTable(n))}},sortTable:function(e,r){var s=this,c=e.cellIndex,l=a,p="",d=[],f=s.thead?0:1,u=e.getAttribute("data-sort-method");if(s.table.dispatchEvent(i("beforeSort")),!(s.table.rows.length<2)){if(!u){for(;d.length<3&&f<s.table.tBodies[0].rows.length;)p=n(s.table.tBodies[0].rows[f].cells[c]),p=p.trim(),p.length>0&&d.push(p),f++;if(!d)return}for(f=0;f<t.length;f++)if(p=t[f],u){if(p.name===u){l=p.sort;break}}else if(d.every(p.pattern)){l=p.sort;break}s.col=c;var m,g,x=[],h={},v=0,y=0;for(f=0;f<s.table.tBodies.length;f++)for(m=0;m<s.table.tBodies[f].rows.length;m++)p=s.table.tBodies[f].rows[m],p.classList.contains("no-sort")?h[v]=p:x.push({tr:p,td:n(p.cells[s.col]),index:v}),v++;for(r?g=e.classList.contains("sort-up")?"sort-up":"sort-down":(g=e.classList.contains("sort-up")?"sort-down":e.classList.contains("sort-down")?"sort-up":s.options.descending?"sort-up":"sort-down",e.classList.remove("sort-down"===g?"sort-up":"sort-down"),e.classList.add(g)),"sort-down"===g?(x.sort(o(l,!0)),x.reverse()):x.sort(o(l,!1)),f=0;v>f;f++)h[f]?(p=h[f],y++):p=x[f-y].tr,s.table.tBodies[0].appendChild(p);s.table.dispatchEvent(i("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=e:window.Tablesort=e}();var filesapp;window.onpopstate=function(e){fileApp(e.state.location)},window.onload=function(){filesapp=document.getElementById("filesapp"),history.replaceState({location:filesapp.dataset.api},"Files Listing",window.location.href),fileApp(filesapp.dataset.api)},IconMap={"7z":"application-x-7z-compressed",aac:"audio-x-generic",apk:"android-package-archive",apng:"image-png",atom:"application-atom+xml",avi:"audio-x-generic",bash:"application-x-executable-script",bmp:"image-bmp",c:"text-x-csrc",cfg:"text-x-generic",coffee:"application-x-javascript",conf:"text-x-generic",cpp:"text-x-c++src",csh:"application-x-executable-script",css:"text-css",csv:"text-csv",db:"application-vnd.oasis.opendocument.database",deb:"application-x-deb",desktop:"application-x-desktop",doc:"x-office-document",docx:"x-office-document",eml:"message-rfc822",epub:"application-epub+zip",erb:"application-x-ruby",ex:"text-x-generic",exe:"application-x-executable",fla:"video-x-generic",flac:"audio-x-flac",flv:"video-x-generic",gif:"image-gif",gml:"text-xml",go:"text-x-generic",gpx:"text-xml",gz:"application-x-gzip",h:"text-x-chdr",hxx:"text-x-c++hdr",hs:"text-x-haskell",htm:"text-html",html:"text-html",ico:"image-x-ico",ini:"text-x-generic",iso:"application-x-cd-image",jar:"application-x-java-archive",java:"application-x-java",jpeg:"image-jpeg",jpg:"image-jpeg",js:"application-x-javascript",log:"text-x-generic",lua:"text-x-generic",m3u:"audio-x-generic",markdown:"text-x-generic",md:"text-x-generic",mkv:"video-x-matroska",mp3:"audio-x-mpeg",mp4:"video-mp4",odp:"x-office-presentation",ods:"x-office-spreadsheet",odt:"x-office-document",ogg:"audio-x-generic",otf:"application-x-font-otf",pdf:"application-pdf",pgp:"application-pgp",php:"application-x-php",pkg:"package-x-generic",pl:"application-x-perl",png:"image-png",ppt:"x-office-presentation",pptx:"x-office-presentation",psd:"image-x-psd",py:"text-x-generic",pyc:"application-x-python-bytecode",rar:"application-x-rar",rb:"application-x-ruby",rpm:"application-x-rpm",rtf:"text-rtf",sh:"application-x-executable-script",svg:"image-svg+xml-compressed",svgz:"image-svg+xml-compressed",swf:"application-x-shockwave-flash",tar:"application-x-tar",text:"text-x-generic",tiff:"image-tiff",ttf:"application-x-font-ttf",txt:"text-x-generic",wav:"audio-x-wav",webm:"video-webm",wmv:"video-x-wmv",xcf:"image-x-xcf",xhtml:"text-html",xls:"x-office-spreadsheet",xlsx:"x-office-spreadsheet",xml:"text-xml",xpi:"package-x-generic",xz:"application-x-lzma-compressed-tar",zip:"application-zip",zsh:"application-x-executable-script",opml:"text-xml"},function(){var e=function(e){return new Date(e).getTime()||-1};Tablesort.extend("date",function(t){return(t.search(/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i)!==-1||t.search(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/)!==-1||t.search(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i)!==-1)&&!isNaN(e(t))},function(t,i){return e(t)-e(i)})}(),function(){var e=function(e){return e.replace(/[^\-?0-9.]/g,"")},t=function(e,t){return e=parseFloat(e),t=parseFloat(t),e=isNaN(e)?0:e,t=isNaN(t)?0:t,e-t};Tablesort.extend("number",function(e){return e.match(/^-?[£\x24Û¢´€]?\d+\s*([,\.]\d{0,2})/)||e.match(/^-?\d+\s*([,\.]\d{0,2})?[£\x24Û¢´€]/)||e.match(/^-?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)},function(i,n){return i=e(i),n=e(n),t(n,i)})}(),Number.prototype.padLeft=function(e,t){var i=String(e||10).length-String(this).length+1;return i>0?new Array(i).join(t||"0")+this:this},Date.prototype.toISOString||!function(){function e(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();